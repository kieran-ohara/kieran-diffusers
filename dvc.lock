schema: '2.0'
stages:
  train:
    cmd: accelerate launch submodules/diffusers/examples/dreambooth/train_dreambooth.py  --pretrained_model_name_or_path="CompVis/stable-diffusion-v1-4"
      --class_data_dir="src/train/data/classes/cat/800" --class_prompt="cat"  --num_class_images="800"  --instance_data_dir="src/train/data/instances/joyce"
      --instance_prompt="kostancat"  --output_dir=src/train/model  --with_prior_preservation  --prior_loss_weight=1.0  --resolution=512  --train_batch_size=1  --gradient_accumulation_steps=1  --learning_rate="3e-06"  --lr_scheduler="constant"  --lr_warmup_steps=0  --max_train_steps="800"  --gradient_checkpointing  --mixed_precision=fp16  --use_8bit_adam
    params:
      params.yaml:
        class.count: 800
        class.dir: src/train/data/classes/cat/800
        class.prompt: cat
        instance.dir: src/train/data/instances/joyce
        instance.prompt: kostancat
        learning_rate: 3e-06
        pretrained_model: CompVis/stable-diffusion-v1-4
        training_steps: 800
    outs:
    - path: src/train/model/800
      md5: 14f159cb3718a8a9d124ae1f32f071ad.dir
      size: 4266985318
      nfiles: 13
  infer:
    cmd: "src/infer/infer.py 800 -p jprompt -i kostancat -c cat\n"
    deps:
    - path: src/train/model/800
      md5: 14f159cb3718a8a9d124ae1f32f071ad.dir
      size: 4266985318
      nfiles: 13
    params:
      params.yaml:
        class.prompt: cat
        instance.prompt: kostancat
    outs:
    - path: src/infer/output
      md5: 8277874f32473c23d7583f86c44e8d12.dir
      size: 9018153
      nfiles: 1
  evaluate:
    cmd: infer/infer.py 10
    deps:
    - path: data/model/10
      md5: bf6ecc76507ee962ce456e724e57a91d.dir
      size: 4276362916
      nfiles: 14
